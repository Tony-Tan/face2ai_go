<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>【数值分析】0.4 有效数字缺失 | 谭升的博客</title><meta name=keywords content="有效数字缺失"><meta name=description content="Abstract: 本文介绍计算机在计算中有可能引发的有效数字缺失
Keywords: 有效数字缺失"><meta name=author content="谭升"><link rel=canonical href=https://go.face2ai.com/math/math-numerical-analysis-0-4-significant-digit.zh/><link crossorigin=anonymous href=../../assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe+FVUFzPh7U=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=../../assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://go.face2ai.com/logo.png><link rel=icon type=image/png sizes=16x16 href=https://go.face2ai.com/logo.png><link rel=icon type=image/png sizes=32x32 href=https://go.face2ai.com/logo.png><link rel=apple-touch-icon href=https://go.face2ai.com/logo.png><link rel=mask-icon href=https://go.face2ai.com/logo.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,o,i,a,t,n,s){e.GoogleAnalyticsObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=o.createElement(i),s=o.getElementsByTagName(i)[0],n.async=1,n.src=a,s.parentNode.insertBefore(n,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-105335860-3","auto"),ga("send","pageview"))</script><meta property="og:title" content="【数值分析】0.4 有效数字缺失"><meta property="og:description" content="Abstract: 本文介绍计算机在计算中有可能引发的有效数字缺失
Keywords: 有效数字缺失"><meta property="og:type" content="article"><meta property="og:url" content="https://go.face2ai.com/math/math-numerical-analysis-0-4-significant-digit.zh/"><meta property="article:section" content="math"><meta property="article:published_time" content="2018-06-13T19:16:27+00:00"><meta property="article:modified_time" content="2023-04-04T15:19:02+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="【数值分析】0.4 有效数字缺失"><meta name=twitter:description content="Abstract: 本文介绍计算机在计算中有可能引发的有效数字缺失
Keywords: 有效数字缺失"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Maths","item":"https://go.face2ai.com/math/"},{"@type":"ListItem","position":3,"name":"【数值分析】0.4 有效数字缺失","item":"https://go.face2ai.com/math/math-numerical-analysis-0-4-significant-digit.zh/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"【数值分析】0.4 有效数字缺失","name":"【数值分析】0.4 有效数字缺失","description":"Abstract: 本文介绍计算机在计算中有可能引发的有效数字缺失 Keywords: 有效数字缺失\n","keywords":["有效数字缺失"],"articleBody":"Abstract: 本文介绍计算机在计算中有可能引发的有效数字缺失 Keywords: 有效数字缺失\n有效数字缺失 对计算机硬件或者底层功能足够了解，虽然表面教条枯燥，但是我们能在其中学到很多有可能出现，但是不容易察觉的陷阱\n有效数字 在了解有效数字缺失之前，我们有必要确定下什么是有效数字，无论是小数还是大数，我们都能写成科学计数法的形式，在十进制下我们可以把所有数字写成： $$ d_1.d_2\\cdots d_n \\times 10^p $$ 的这种形式，其中 $d_1\\neq 0$，有效数字是 $d_1.d_2\\cdots d_n$ 共 $n$ 位，注意我们这里之研究数学上的有效数字，物理中测量还有另一套说法，我们不考虑. 有效数字我们知道是什么了，那么什么情况下会缺失呢？数字不会凭空消失，一定是做了某种计算后，原本有 $n$ 位有效数字，结果变成了小于 $n$ 位，这就是缺失，而缺失不可能发生在右侧，也就是 $d_n$ 这一侧，原因是，如果这些位消失了，我们依然可以补充0作为有效数字，所以我们要注意左侧的数字。 比如： $$ \\begin{aligned} \u0026123.4567\\ -\u0026123.4566\\ \u0026\\hline\\ =\u0026000.0001 \\end{aligned} $$\n这时候，我们原本的7位有效数字，瞬间变成1位，有问题么？没有问题，因为这是准确结果，但是从数值上看，有效数字减少了。 但是，如果减法的两个操作数，减数或者被减数，并不是一个确定的数，而是一个表达式，包含无限的小数呢？\n“减法”=“陷阱” 考虑 $\\sqrt{9.01}-3$ 这个表达式的值。 这个例子很简答，输入matlab能够直接得到答案，$\\sqrt{9.01}\\approx 3.001 662$ 所以 $\\sqrt{9.01}-3\\approx |0.001 662$ 减法之前有七位有效数字，结果有4位有效数字，也就是少了3位，这看起来没啥。 然后我们假定，我们有一种特殊的计算机，其浮点数最多只能保存十进制的3位有效数字，（书中说是三位计算机，表达不是很准确，会和三个二进制位混淆，所以我们说这个计算机只能计算3位十进制）那么我们如果按照上面的计算过程，那么会得到： $$ \\sqrt{9.01}\\approx 3.001 662=3.00\\ \\sqrt{9.01}-3=0 $$ 结果是0，第一步我们把3.001662保存成3.00 的原因是计算机只能保存3位十进制数，所以这个结果是截断误差造成的，然后相减得到了|0.00，理想情况，有效数字是1.66，可见一个都不对。 我们这里所说的有效数字是和真实计算结果数字上的比较，不是比较大小，只考虑尾数，不考虑指数。 两个相近的数相减，可能会造成有效数字的缺失 但是你可能说，没办法，这是机器的限制，你那个能存一百位有效数字的计算机来就可以了，如果你这么想，那就没得聊了， 有没有办法？当然有办法！\n解决方法 解决办法的核心思想是：把相近的两个数变成不相近的！ 同样使用只有三维有效数字的计算机 $$ \\sqrt{9.01}-3=\\frac{(\\sqrt{9.01}-3)(\\sqrt{9.01}+3)}{\\sqrt{9.01}+3}=\\frac{|0.01}{3.00+3}=\\frac{1}{6}=1.67\\times 10^{-3} $$ 上面这种方法叫做共轭等式，可以避免两个相近的数字相减。下面我们看另一个例子，主要技巧也是用一些恒等式： $$ E_1=\\frac{1-\\text{cos}x}{\\text{sin}^2x} $$ 明显得当$x\\to 0$ 的时候 $\\text{cos}x\\to 1$ 那么就有可能造成有效数字缺失，与上面类似的，我们也有共轭等式： $$ E_2=\\frac{(1-\\text{cos}x)(1+\\text{cos}x)}{\\text{sin}^2x(1+\\text{cos}x)}=\\frac{1}{(1+\\text{cos}x)}=E_1 $$ 然后我们就写个代码来观察下 $E_1$ 和 $E_2$ 在 $x\\to 0$ 的时候的表现，是否 $E_2$ 更准确，我们写一段python程序：\nimport math x=1.0 for i in range(0,16): x=x/10 cos_x=math.cos(x) sin_x=math.sin(x) e1=(1- cos_x)/pow(sin_x,2) e2 = (1 ) / (1 + cos_x) print '|%1.16f|%1.16f|%1.16f|' % (x,e1,e2) 运行结果是：\n   $x$ $E_1$ $E_2$     0.1000000000000000 0.5012520862885769 0.5012520862885712   0.0100000000000000 0.5000125002084805 0.5000125002083363   0.0010000000000000 0.5000001249921894 0.5000001250000208   0.0001000000000000 0.4999999986279311 0.5000000012500000   0.0000100000000000 0.5000000413868522 0.5000000000125000   0.0000010000000000 0.5000444502913370 0.5000000000001250   0.0000001000000000 0.4996003610813219 0.5000000000000012   0.0000000100000000 0.0000000000000000 0.5000000000000000   0.0000000010000000 0.0000000000000000 0.5000000000000000   0.0000000001000000 0.0000000000000000 0.5000000000000000   0.0000000000100000 0.0000000000000000 0.5000000000000000   0.0000000000010000 0.0000000000000000 0.5000000000000000   0.0000000000001000 0.0000000000000000 0.5000000000000000   0.0000000000000100 0.0000000000000000 0.5000000000000000   0.0000000000000010 0.0000000000000000 0.5000000000000000   0.0000000000000001 0.0000000000000000 0.5000000000000000    从 0.00000001开始 $E_1$ 崩溃，而 $E_2$ 保持稳定。 到0.00000001崩溃的原因是cos在这个位置截断后就是1.0：\n同样，我们这套方法的核心就是不要见相近的数字，只要有减法就要小心，注意前后两个数是否相近，另一个例子是二次方程的求解，对于公式法我们必须要计算： $$ x=\\frac{-b\\pm\\sqrt{b^2-4ac}}{2a} $$ 其中要注意的是 $$ x_1=\\frac{-b+\\sqrt{b^2-4ac}}{2a} $$ 对应的方法就是把这个计算改成： $$ x_1=\\frac{(-b+\\sqrt{b^2-4ac})\\cdot(+b+\\sqrt{b^2-4ac})}{2a(+b+\\sqrt{b^2-4ac})}=\\frac{-4ac}{2a(+b+\\sqrt{b^2-4ac})}=\\frac{-2c}{(b+\\sqrt{b^2-4ac})} $$ 当然这里面还有问题就是 $b^2-4ac$ 的部分依然存在减法 而且 $b$ 是负数的时候，依然会存在 $b+\\sqrt{b^2-4ac}$ 相近的情况，尤其是 $ac«b^2$ 的时候，这时候计算最好使用： $$ x_1=\\frac{-b+\\sqrt{b^2-4ac}}{2a}\\ x_2=\\frac{2c}{-b+\\sqrt{b^2-4ac}} $$\n总结 有效数字可能会带来很小的误差，也可以带来很大的误差，所以，不管什么时候，我们能避免减法就避免减法，尤其减法的两个数字接近的时候，这个时候更危险。\n","wordCount":"206","inLanguage":"en","datePublished":"2018-06-13T19:16:27Z","dateModified":"2023-04-04T15:19:02+08:00","author":{"@type":"Person","name":"谭升"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://go.face2ai.com/math/math-numerical-analysis-0-4-significant-digit.zh/"},"publisher":{"@type":"Organization","name":"谭升的博客","logo":{"@type":"ImageObject","url":"https://go.face2ai.com/logo.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://go.face2ai.com accesskey=h title="谭升的博客 (Alt + H)">谭升的博客</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://go.face2ai.com/math/ title=数学><span>数学</span></a></li><li><a href=https://go.face2ai.com/archives title=Archive><span>Archive</span></a></li><li><a href=https://go.face2ai.com/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://go.face2ai.com/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://go.face2ai.com/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://go.face2ai.com>Home</a>&nbsp;»&nbsp;<a href=https://go.face2ai.com/math/>Maths</a></div><h1 class=post-title>【数值分析】0.4 有效数字缺失</h1><div class=post-meta><span title="2018-06-13 19:16:27 +0000 UTC">June 13, 2018</span>&nbsp;·&nbsp;谭升</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e6%9c%89%e6%95%88%e6%95%b0%e5%ad%97%e7%bc%ba%e5%a4%b1 aria-label=有效数字缺失>有效数字缺失</a><ul><li><a href=#%e6%9c%89%e6%95%88%e6%95%b0%e5%ad%97 aria-label=有效数字>有效数字</a></li><li><a href=#%e5%87%8f%e6%b3%95%e9%99%b7%e9%98%b1 aria-label="“减法”=“陷阱”">“减法”=“陷阱”</a></li><li><a href=#%e8%a7%a3%e5%86%b3%e6%96%b9%e6%b3%95 aria-label=解决方法>解决方法</a></li><li><a href=#%e6%80%bb%e7%bb%93 aria-label=总结>总结</a></li></ul></li></ul></div></details></div><div class=post-content><p><strong>Abstract:</strong> 本文介绍计算机在计算中有可能引发的有效数字缺失
<strong>Keywords:</strong> 有效数字缺失</p><h1 id=有效数字缺失>有效数字缺失<a hidden class=anchor aria-hidden=true href=#有效数字缺失>#</a></h1><p>对计算机硬件或者底层功能足够了解，虽然表面教条枯燥，但是我们能在其中学到很多有可能出现，但是不容易察觉的陷阱</p><h2 id=有效数字>有效数字<a hidden class=anchor aria-hidden=true href=#有效数字>#</a></h2><p>在了解有效数字缺失之前，我们有必要确定下什么是有效数字，无论是小数还是大数，我们都能写成科学计数法的形式，在十进制下我们可以把所有数字写成：
$$
d_1.d_2\cdots d_n \times 10^p
$$
的这种形式，其中 $d_1\neq 0$，有效数字是 $d_1.d_2\cdots d_n$ 共 $n$ 位，注意我们这里之研究数学上的有效数字，物理中测量还有另一套说法，我们不考虑.
有效数字我们知道是什么了，那么什么情况下会缺失呢？数字不会凭空消失，一定是做了某种计算后，原本有 $n$ 位有效数字，结果变成了小于 $n$ 位，这就是缺失，而缺失不可能发生在右侧，也就是 $d_n$ 这一侧，原因是，如果这些位消失了，我们依然可以补充0作为有效数字，所以我们要注意左侧的数字。
比如：
$$
\begin{aligned}
&123.4567\
-&123.4566\
&\hline\
=&000.0001
\end{aligned}
$$</p><p>这时候，我们原本的7位有效数字，瞬间变成1位，有问题么？没有问题，因为这是准确结果，但是从数值上看，有效数字减少了。
但是，如果减法的两个操作数，减数或者被减数，并不是一个确定的数，而是一个表达式，包含无限的小数呢？</p><h2 id=减法陷阱>“减法”=“陷阱”<a hidden class=anchor aria-hidden=true href=#减法陷阱>#</a></h2><p>考虑 $\sqrt{9.01}-3$ 这个表达式的值。
这个例子很简答，输入matlab能够直接得到答案，$\sqrt{9.01}\approx 3.001 662$ 所以 $\sqrt{9.01}-3\approx |0.001 662$ 减法之前有七位有效数字，结果有4位有效数字，也就是少了3位，这看起来没啥。
然后我们假定，我们有一种特殊的计算机，其浮点数最多只能保存十进制的3位有效数字，（书中说是三位计算机，表达不是很准确，会和三个二进制位混淆，所以我们说这个计算机只能计算3位十进制）那么我们如果按照上面的计算过程，那么会得到：
$$
\sqrt{9.01}\approx 3.001 662=3.00\
\sqrt{9.01}-3=0
$$
结果是0，第一步我们把3.001662保存成3.00 的原因是计算机只能保存3位十进制数，所以这个结果是截断误差造成的，然后相减得到了|0.00，理想情况，有效数字是1.66，可见一个都不对。
我们这里所说的有效数字是和真实计算结果数字上的比较，不是比较大小，只考虑尾数，不考虑指数。
两个相近的数相减，可能会造成有效数字的缺失
但是你可能说，没办法，这是机器的限制，你那个能存一百位有效数字的计算机来就可以了，如果你这么想，那就没得聊了，
有没有办法？当然有办法！</p><h2 id=解决方法>解决方法<a hidden class=anchor aria-hidden=true href=#解决方法>#</a></h2><p>解决办法的核心思想是：把相近的两个数变成不相近的！
同样使用只有三维有效数字的计算机
$$
\sqrt{9.01}-3=\frac{(\sqrt{9.01}-3)(\sqrt{9.01}+3)}{\sqrt{9.01}+3}=\frac{|0.01}{3.00+3}=\frac{1}{6}=1.67\times 10^{-3}
$$
上面这种方法叫做共轭等式，可以避免两个相近的数字相减。下面我们看另一个例子，主要技巧也是用一些恒等式：
$$
E_1=\frac{1-\text{cos}x}{\text{sin}^2x}
$$
明显得当$x\to 0$ 的时候 $\text{cos}x\to 1$ 那么就有可能造成有效数字缺失，与上面类似的，我们也有共轭等式：
$$
E_2=\frac{(1-\text{cos}x)(1+\text{cos}x)}{\text{sin}^2x(1+\text{cos}x)}=\frac{1}{(1+\text{cos}x)}=E_1
$$
然后我们就写个代码来观察下 $E_1$ 和 $E_2$ 在 $x\to 0$ 的时候的表现，是否 $E_2$ 更准确，我们写一段python程序：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>math</span>
</span></span><span class=line><span class=cl><span class=n>x</span><span class=o>=</span><span class=mf>1.0</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>16</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span><span class=o>=</span><span class=n>x</span><span class=o>/</span><span class=mi>10</span>
</span></span><span class=line><span class=cl>    <span class=n>cos_x</span><span class=o>=</span><span class=n>math</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sin_x</span><span class=o>=</span><span class=n>math</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>e1</span><span class=o>=</span><span class=p>(</span><span class=mi>1</span><span class=o>-</span> <span class=n>cos_x</span><span class=p>)</span><span class=o>/</span><span class=nb>pow</span><span class=p>(</span><span class=n>sin_x</span><span class=p>,</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>e2</span> <span class=o>=</span> <span class=p>(</span><span class=mi>1</span> <span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>cos_x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span> <span class=s1>&#39;|</span><span class=si>%1.16f</span><span class=s1>|</span><span class=si>%1.16f</span><span class=s1>|</span><span class=si>%1.16f</span><span class=s1>|&#39;</span> <span class=o>%</span> <span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=n>e1</span><span class=p>,</span><span class=n>e2</span><span class=p>)</span>
</span></span></code></pre></div><p>运行结果是：</p><table><thead><tr><th style=text-align:center>$x$</th><th style=text-align:center>$E_1$</th><th style=text-align:center>$E_2$</th></tr></thead><tbody><tr><td style=text-align:center>0.1000000000000000</td><td style=text-align:center>0.5012520862885769</td><td style=text-align:center>0.5012520862885712</td></tr><tr><td style=text-align:center>0.0100000000000000</td><td style=text-align:center>0.5000125002084805</td><td style=text-align:center>0.5000125002083363</td></tr><tr><td style=text-align:center>0.0010000000000000</td><td style=text-align:center>0.5000001249921894</td><td style=text-align:center>0.5000001250000208</td></tr><tr><td style=text-align:center>0.0001000000000000</td><td style=text-align:center>0.4999999986279311</td><td style=text-align:center>0.5000000012500000</td></tr><tr><td style=text-align:center>0.0000100000000000</td><td style=text-align:center>0.5000000413868522</td><td style=text-align:center>0.5000000000125000</td></tr><tr><td style=text-align:center>0.0000010000000000</td><td style=text-align:center>0.5000444502913370</td><td style=text-align:center>0.5000000000001250</td></tr><tr><td style=text-align:center>0.0000001000000000</td><td style=text-align:center>0.4996003610813219</td><td style=text-align:center>0.5000000000000012</td></tr><tr><td style=text-align:center>0.0000000100000000</td><td style=text-align:center>0.0000000000000000</td><td style=text-align:center>0.5000000000000000</td></tr><tr><td style=text-align:center>0.0000000010000000</td><td style=text-align:center>0.0000000000000000</td><td style=text-align:center>0.5000000000000000</td></tr><tr><td style=text-align:center>0.0000000001000000</td><td style=text-align:center>0.0000000000000000</td><td style=text-align:center>0.5000000000000000</td></tr><tr><td style=text-align:center>0.0000000000100000</td><td style=text-align:center>0.0000000000000000</td><td style=text-align:center>0.5000000000000000</td></tr><tr><td style=text-align:center>0.0000000000010000</td><td style=text-align:center>0.0000000000000000</td><td style=text-align:center>0.5000000000000000</td></tr><tr><td style=text-align:center>0.0000000000001000</td><td style=text-align:center>0.0000000000000000</td><td style=text-align:center>0.5000000000000000</td></tr><tr><td style=text-align:center>0.0000000000000100</td><td style=text-align:center>0.0000000000000000</td><td style=text-align:center>0.5000000000000000</td></tr><tr><td style=text-align:center>0.0000000000000010</td><td style=text-align:center>0.0000000000000000</td><td style=text-align:center>0.5000000000000000</td></tr><tr><td style=text-align:center>0.0000000000000001</td><td style=text-align:center>0.0000000000000000</td><td style=text-align:center>0.5000000000000000</td></tr></tbody></table><p>从 0.00000001开始 $E_1$ 崩溃，而 $E_2$ 保持稳定。
到0.00000001崩溃的原因是cos在这个位置截断后就是1.0：</p><p><img loading=lazy src=./re-2.png alt=re-2></p><p>同样，我们这套方法的核心就是不要见相近的数字，只要有减法就要小心，注意前后两个数是否相近，另一个例子是二次方程的求解，对于公式法我们必须要计算：
$$
x=\frac{-b\pm\sqrt{b^2-4ac}}{2a}
$$
其中要注意的是
$$
x_1=\frac{-b+\sqrt{b^2-4ac}}{2a}
$$
对应的方法就是把这个计算改成：
$$
x_1=\frac{(-b+\sqrt{b^2-4ac})\cdot(+b+\sqrt{b^2-4ac})}{2a(+b+\sqrt{b^2-4ac})}=\frac{-4ac}{2a(+b+\sqrt{b^2-4ac})}=\frac{-2c}{(b+\sqrt{b^2-4ac})}
$$
当然这里面还有问题就是 $b^2-4ac$ 的部分依然存在减法
而且 $b$ 是负数的时候，依然会存在 $b+\sqrt{b^2-4ac}$ 相近的情况，尤其是 $ac&#171;b^2$ 的时候，这时候计算最好使用：
$$
x_1=\frac{-b+\sqrt{b^2-4ac}}{2a}\
x_2=\frac{2c}{-b+\sqrt{b^2-4ac}}
$$</p><h2 id=总结>总结<a hidden class=anchor aria-hidden=true href=#总结>#</a></h2><p>有效数字可能会带来很小的误差，也可以带来很大的误差，所以，不管什么时候，我们能避免减法就避免减法，尤其减法的两个数字接近的时候，这个时候更危险。</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://go.face2ai.com/tags/%E6%9C%89%E6%95%88%E6%95%B0%E5%AD%97%E7%BC%BA%E5%A4%B1/>有效数字缺失</a></li></ul><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share 【数值分析】0.4 有效数字缺失 on twitter" href="https://twitter.com/intent/tweet/?text=%e3%80%90%e6%95%b0%e5%80%bc%e5%88%86%e6%9e%90%e3%80%910.4%20%e6%9c%89%e6%95%88%e6%95%b0%e5%ad%97%e7%bc%ba%e5%a4%b1&url=https%3a%2f%2fgo.face2ai.com%2fmath%2fmath-numerical-analysis-0-4-significant-digit.zh%2f&hashtags=%e6%9c%89%e6%95%88%e6%95%b0%e5%ad%97%e7%bc%ba%e5%a4%b1"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share 【数值分析】0.4 有效数字缺失 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fgo.face2ai.com%2fmath%2fmath-numerical-analysis-0-4-significant-digit.zh%2f&title=%e3%80%90%e6%95%b0%e5%80%bc%e5%88%86%e6%9e%90%e3%80%910.4%20%e6%9c%89%e6%95%88%e6%95%b0%e5%ad%97%e7%bc%ba%e5%a4%b1&summary=%e3%80%90%e6%95%b0%e5%80%bc%e5%88%86%e6%9e%90%e3%80%910.4%20%e6%9c%89%e6%95%88%e6%95%b0%e5%ad%97%e7%bc%ba%e5%a4%b1&source=https%3a%2f%2fgo.face2ai.com%2fmath%2fmath-numerical-analysis-0-4-significant-digit.zh%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share 【数值分析】0.4 有效数字缺失 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fgo.face2ai.com%2fmath%2fmath-numerical-analysis-0-4-significant-digit.zh%2f&title=%e3%80%90%e6%95%b0%e5%80%bc%e5%88%86%e6%9e%90%e3%80%910.4%20%e6%9c%89%e6%95%88%e6%95%b0%e5%ad%97%e7%bc%ba%e5%a4%b1"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share 【数值分析】0.4 有效数字缺失 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fgo.face2ai.com%2fmath%2fmath-numerical-analysis-0-4-significant-digit.zh%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share 【数值分析】0.4 有效数字缺失 on whatsapp" href="https://api.whatsapp.com/send?text=%e3%80%90%e6%95%b0%e5%80%bc%e5%88%86%e6%9e%90%e3%80%910.4%20%e6%9c%89%e6%95%88%e6%95%b0%e5%ad%97%e7%bc%ba%e5%a4%b1%20-%20https%3a%2f%2fgo.face2ai.com%2fmath%2fmath-numerical-analysis-0-4-significant-digit.zh%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share 【数值分析】0.4 有效数字缺失 on telegram" href="https://telegram.me/share/url?text=%e3%80%90%e6%95%b0%e5%80%bc%e5%88%86%e6%9e%90%e3%80%910.4%20%e6%9c%89%e6%95%88%e6%95%b0%e5%ad%97%e7%bc%ba%e5%a4%b1&url=https%3a%2f%2fgo.face2ai.com%2fmath%2fmath-numerical-analysis-0-4-significant-digit.zh%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://go.face2ai.com>谭升的博客</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerHTML="copy";function s(){e.innerHTML="copied!",setTimeout(()=>{e.innerHTML="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>