---
title: 【概率论】1-4:事件的的并集(Union of Events and Statical Swindles)
categories:
  - Mathematic
  - Probability
tags:
  - 两个事件的并
  - 有限个事件的并
  - 概率欺骗
toc: true
date: 2018-01-30 09:22:40
---

**Abstract:** 本文主要介绍事件的并集对应的概率计算，以及一个补充的概率小知识，怎么用统计骗人
**Keywords:** Union of two Events，Union of Finite Number of Events，Statical Swindles

<!--more-->
# 事件的的并集
废话还是说说数学吧，学数学真的看不到立竿见影的事，相比学个C++、TensorFlow，这些更有成就感，毕竟写了就有结果可以看，数学学习的结果就是，你可能只会做两道题，没办法直接让你升值加薪，但是凡事都有因果，通过这几个月简单的学习，我发现身边的很多事都能用数学解释，比如今天要写的，如果我早些学习可能可以避免很多不必要的损失，而且通过学数学分析，可以通过一个人的语言来判断这个人的逻辑，进而判断这个人的性格，这是心理学的内容了，我不懂心理学，但是很感兴趣，如果有机会去研究下心理学，毕竟也跟人工智能强相关。
本篇介绍两个小知识点，关于事件的并集的概率求法，以及一些概率的日常应用

## 两个事件的并 Union of Two Events
在前面[1-1概率定义](http://face2ai.com/Math-Probability-1-1-Definition-of-Probability/)中的T7给出了两个相交的事件的并集的概率计算方法：
$$Pr(A\cup B)=Pr(A)+Pr(B)-Pr(A\cap B)$$
详细的证明在1-1中也有给出，这个公式在本文中将会进一步展开，把其延展到无数项，但是在开始之前我们还是来复习下这个定理，事件是试验结果的集合，集合的基本运算就是交，并，补，补集和概率的对应我们在1-1中的T3就是最基础的补集的概率计算，剩下就是交集和并集的计算了，T7给出了两个集合并集的概率计算公式，并给出了分析的证明方法，之前看书和上课老师都是给我们画个Venn图没然后说 $Pr(A\cup B)$ 是 $Pr(A)+Pr(B)$ 但是重复加了一遍 $Pr(A\cap B)$ 所以要减去。
![](./two_events.png)

提到Venn图说一下，就是关于理解数学，到底是用图形化的可视化的方法好，还是分析法好，这个没办法一棍子打死，大学之前老师们都喜欢用画图的方法教大家理解概念知识点，原因是高中，初中，知识点极其少，更多是的各种拐弯的习题，所以为了加深大家的理解，画个图，直观，而且更容易被人接受，但是到了大学以后，画图就不再合适了，因为知识点变多，而且有很多没办法用二维三维的图来解释，所以，分析的方法到了大学以后是更有用的，拿机器学习的例子来说，做可视化是一个方向，但是这个方向的结果大多是为了展示给一些没有背景的人来看的，业内人士多半关注参数。

这里说了一大堆话的目的就是说明，分析到后面越来越有用，所以数学分析是数学系的开蒙课程。
## 有限个事件的并 Union of Finite Number of Events
多个事件的并集，就是对上面“分析”理论的一个很好的诠释，当事件数量超过五个，Venn图马上就乱掉了，我们这里省去三个事件的并集的概率计算，直接进行更高难度的有限个事件的并集：

> Theorem For every events $A_1,\dots,A_n$ ,
$$
Pr(\bigcup^n_{i=1}A_i)=\sum^n_{i=1}Pr(A_i)-\sum_{i<j}Pr(A_i\cap A_j)\\
+\sum_{i<j<k}(A_i\cap A_j \cap A_k)-\sum_{i<j<k<l}(A_i\cap A_j\cap A_k \cap A_l)+\\
\dots + (-1)^{n+1}Pr(A_1\cap A_2 \cap \dots \cap A_n)
$$

给出了个公式，证明过程其实就是一个分析过程，所以证明需要用数学语言来完成，而不是画个图放在那，那么我们来分析这个问题，首先这个公式的变量n是个自然数，那么最基础的方法就是归纳法。
1. 当$n=1$ 时，显然是成立的，其与1-1中的T7相等。
2. 设当 $n=m$ 时成立
$$Pr(\bigcup^m_{i=1}A_i)=\sum^m_{i=1}Pr(A_i)-\sum_{i<j}Pr(A_i\cap A_j)\\
+\sum_{i<j<k}(A_i\cap A_j \cap A_k)-\sum_{i<j<k<l}(A_i\cap A_j\cap A_k \cap A_l)+\\
\dots + (-1)^{m+1}Pr(A_1\cap A_2 \cap \dots \cap A_m)$$
3. 当 $n=m+1$ 时，我们套用$Pr(A\cup B)=Pr(A)+Pr(B)-Pr(A\cap B)$ 公式，
- 其中 $\bigcup^m_{i=1}A_i$ 为$A$，$A_{m+1}$ 为 $B$
- 那么，$A\cup B=\bigcup^{m+1}_{i=1}A_i$
- 最关键的是 $A\cap B=\bigcup^{m}_{i=1}(A_i\cap A_{m+1})$ ，可以根据集合论的工时得到，可以看到 $Pr(B)-Pr(A\cap B)$ 有：
$$
Pr(B)-Pr(A\cap B)=Pr(A_{m+1})-\sum^m_{i=1}Pr(A_i\cap A_{m+1})+\sum_{i<j}Pr(A_i\cap A_j \cap A_{m+1})\\
-\sum_{i<j<k}(A_i\cap A_j \cap A_k \cap A_{m+1})+\sum_{i<j<k<l}(A_i\cap A_j\cap A_k \cap A_l\cap A_{m+1})-\\
\dots + (-1)^{m+2}Pr(A_1\cap A_2 \cap \dots \cap A_{m+1}))
$$
- 最关键的是，当$n=m+1$ 时，$Pr(\bigcup^{m+1}_{i=1}A_i)-Pr(\bigcup^{m}_{i=1}A_i)$ 和上面的表达式一致(计算过程太复杂，所以，这里省略)
- Q.E.D

上述证明比较粗糙，大家可以自己计算下，对于有限时间的并集的概率计算大致的意思就是加多了减，减多了再加，直观的，可以通过画三个集合的Venn图来观察，分析的，就是上述的大致过程。

## 匹配问题 Matching Problem
上面是严格的数学证明，下面我们来分析一个简单但是有趣的应用，其中用到了多事件并集的概率计算，matching problem，配对或者叫做匹配游戏。
描述下问题，假设我们已有一个n个不同的符号的序列，我们来自己随便排列这n个符号的顺序（我们不知道这已有的排列顺序），如果我们排列的符号序列对应位置上的符号和已有符号能够对应上，就叫做一个match，那么当n变化的时候，match的概率$p_{n}$ 怎么描述呢？

>分析：
- 假设第i个字母matching的事件为$A_i$，其概率$Pr(A_i)=\frac{1}{n}$，
- 如果有1个match(k=1):$\sum^{n}_{i=1}Pr(A_i)=n\cdot \frac{1}{n}=\frac{1}{1!}$
- 如果有2个match(k=2):$\sum^{n}_{i<j}Pr(A_i\cap A_j)=\begin{pmatrix}n\\2\end{pmatrix}\cdot \frac{1}{n(n-1)}=\frac{1}{2!}$
- 如果有3个match(k=3):$\sum^{n}_{i<j<m}Pr(A_i\cap A_j\cap A_3)=\begin{pmatrix}n\\3\end{pmatrix}\cdot \frac{1}{n(n-1)(n-2)}=\frac{1}{3!}$
- $\vdots$
- 如果有k个match: $\begin{pmatrix}n\\k\end{pmatrix}\cdot\frac{n!}{(n-k)!}=\frac{1}{k!}$
- 所以，根据我们上面证明多事件并集得到的公式$p_n=\frac{1}{1!}-\frac{1}{2!}+\frac{1}{3!}-\frac{1}{4!}\dots +(-1){n+1}\frac{1}{n!}$
- 当$lim_{n\to \infty}p_n=\frac{1}{1!}-\frac{1}{2!}+\frac{1}{3!}-\frac{1}{4!}\dots +(-1){n+1}\frac{1}{n!}=1-\frac{1}{e}\approx 0.63212$

也就是说当n无限多的时候，匹配成功的概率将会收敛到0.63212。我们可以发现当n=7的时候，写个小程序计算下结果：
```python
a=20
result=1.0
factorial=1
for i in range(2,a,1):
    factorial=factorial * (i )
    result+=(-1)**(i+1)*(1.0/(factorial))
    print 'n='+`i`+':'+`result`
```
```python
n=2:0.5
n=3:0.6666666666666666
n=4:0.625
n=5:0.6333333333333333
n=6:0.6319444444444444
n=7:0.6321428571428571
n=8:0.6321180555555556
n=9:0.632120811287478
n=10:0.6321205357142857
n=11:0.6321205607663941
n=12:0.6321205586787184
n=13:0.6321205588393088
n=14:0.6321205588278381
n=15:0.6321205588286029
n=16:0.6321205588285551
n=17:0.6321205588285579
n=18:0.6321205588285578
n=19:0.6321205588285578

Process finished with exit code 0

```

仔细观察发现当n=7的时候，就已经开始收敛了，也就是说，后面再怎么增加n也不会影响其概率了。
## 概率欺诈 Statistical Swindles
接下来这些话题都是属于知识联系实际的科普小软文，有事的同学可以先行离开了。
### 统计滥用 Misleading Using of Statistics
马克吐温说过：“世界上的谎言有三种，谎言，无耻的谎言，统计”，“你可以通过统计证明任何事情。”
我们学习概率的另一个重要用途就是日常中不会被报纸新闻上的统计信息欺骗，通过已有知识的判断真实的情况。比如经常说的平均工资，人均收入，这些都是统计概念，相比对其真实性大家都有所怀疑。
### 完美预测 Perfect Forecasts
神预测，如果一个投资公司每周一给你推送一只股票，这个股票本周大涨50%，第二周又给你推送了另一只，结果又是大涨50%，第三周第四周，周周如此，你是不是会觉得，卧槽，发财的机会来了，卖房卖地卖媳妇也要进去赚一笔，但是实际投资公司不是神，只是耍了你而已。
他们的做法是什么呢？
首先我们假定其推送的股票涨50%的概率是$Pr=\frac{1}{n}$，那么他们想保证k周有人连续正确，他们只需要发给$n^k$ 个人就可以了
- 第一周，发送给所有人
- 第二周，发给第一周正确地人，正确的人数大概在$n^{k-1}$ 左右
- 第三周，发给第二周正确地人，正确的人数大概在$n^{k-2}$ 左右
- 第四周，发给第二周正确地人，正确的人数大概在$n^{k-3}$ 左右
- $\vdots$
- 第k周，发给第k-1周正确地人，正确的人数大概在$1$左右

怎么样，如果他连续发给你一年都是正确的，可以保证，这个人有内幕消息，估计那样他根本不用发给你，他自己可以卖车卖房卖媳妇，而没必要从你身上赚取服务费了。
完美预测，需要的要么是人多，要么就是概率高一些。
### 保证胜利 Guaranteed Winner
保证胜利，看球赛，有公司这么搞，给你推荐获胜球队，你可以去买彩票或者赌球，推荐对的收取一定服务费，不对不收费，你看起来这事没问题，稳赚不赔，但是，从概率的角度分析，他并不能提高你的获奖概率，而且当你获奖时他要收取服务费，当他没有内幕消息的时候，这个完全是骗人的，而这些公司完全没有任何风险，按照一定的比例给不同的人，推送不同的获胜方，这样他肯定会有收入（肯定会有正确的），具体怎么将收入最大化，那就是优化问题，
### 买彩票 Improving Your Lottery Chances
买彩票，不知道大家有没有买过，我买过，我发现每期都有两个连续的数字，我们来分析下这种现象是否有概率依据。
假设我们的彩票是40个数字选6个，without replacement，各个数字间没有影响，那么这个模型就是个见得组合，那么一共有：
$$
\begin{pmatrix}40\\6\end{pmatrix}=3,838,380
$$
种组合，一等奖，全部命中的概率是 $\frac{1}{3,838,380}$ 那么出现至少两个连续的号码呢？结果是大约有0.577的概率，怎么算？你可以先算出所有号都不连续的组合方式，然后用1-1中的T3，就可以得到一个大概的数字，因为这个存在一个边界的问题，所以还是要小心一点。

## 总结
学习知识，就不会被人骗了，哈哈哈哈，明天继续。。





